# CrowdSec ForwardAuth Middleware Configuration
# This middleware integrates Traefik with CrowdSec for IP-based threat protection

http:
  middlewares:
    crowdsec-bouncer:
      forwardAuth:
        address: http://crowdsec-bouncer-traefik:8080/api/v1/forwardAuth
        trustForwardHeader: true
        authResponseHeaders:
          - X-Forwarded-User
        tls:
          insecureSkipVerify: true

    # Rate limiting middleware to work with CrowdSec
    rate-limit:
      rateLimit:
        average: 100
        burst: 50

    # Security headers for CrowdSec protected routes
    crowdsec-security-headers:
      headers:
        frameDeny: true
        sslRedirect: true
        browserXssFilter: true
        contentTypeNosniff: true
        forceSTSHeader: true
        stsIncludeSubdomains: true
        stsPreload: true
        stsSeconds: 31536000